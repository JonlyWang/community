{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport { onBeforeUnmount, ref, watch, onMounted } from 'vue';\nimport raf from '../../_util/raf';\nvar StatusQueue = ['measure', 'align', null, 'motion'];\nexport default (function (visible, doMeasure) {\n  var status = ref(null);\n  var rafRef = ref();\n  var destroyRef = ref(false);\n\n  function setStatus(nextStatus) {\n    if (!destroyRef.value) {\n      status.value = nextStatus;\n    }\n  }\n\n  function cancelRaf() {\n    raf.cancel(rafRef.value);\n  }\n\n  function goNextStatus(callback) {\n    cancelRaf();\n    rafRef.value = raf(function () {\n      // Only align should be manually trigger\n      var newStatus = status.value;\n\n      switch (status.value) {\n        case 'align':\n          newStatus = 'motion';\n          break;\n\n        case 'motion':\n          newStatus = 'stable';\n          break;\n\n        default:\n      }\n\n      setStatus(newStatus);\n      callback === null || callback === void 0 ? void 0 : callback();\n    });\n  }\n\n  watch(visible, function () {\n    setStatus('measure');\n  }, {\n    immediate: true,\n    flush: 'post'\n  });\n  onMounted(function () {\n    // Go next status\n    watch(status, function () {\n      switch (status.value) {\n        case 'measure':\n          doMeasure();\n          break;\n\n        default:\n      }\n\n      if (status.value) {\n        rafRef.value = raf(function () {\n          return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n            var index, nextStatus;\n            return _regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    index = StatusQueue.indexOf(status.value);\n                    nextStatus = StatusQueue[index + 1];\n\n                    if (nextStatus && index !== -1) {\n                      setStatus(nextStatus);\n                    }\n\n                  case 3:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee);\n          }));\n        });\n      }\n    }, {\n      immediate: true,\n      flush: 'post'\n    });\n  });\n  onBeforeUnmount(function () {\n    destroyRef.value = true;\n    cancelRaf();\n  });\n  return [status, goNextStatus];\n});","map":{"version":3,"names":["_regeneratorRuntime","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","onBeforeUnmount","ref","watch","onMounted","raf","StatusQueue","visible","doMeasure","status","rafRef","destroyRef","setStatus","nextStatus","cancelRaf","cancel","goNextStatus","callback","newStatus","immediate","flush","mark","_callee","index","wrap","_callee$","_context","prev","indexOf","stop"],"sources":["C:/Users/USTC/Desktop/community1/vue-web/node_modules/ant-design-vue/es/vc-trigger/Popup/useVisibleStatus.js"],"sourcesContent":["import _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport { onBeforeUnmount, ref, watch, onMounted } from 'vue';\nimport raf from '../../_util/raf';\nvar StatusQueue = ['measure', 'align', null, 'motion'];\nexport default (function (visible, doMeasure) {\n  var status = ref(null);\n  var rafRef = ref();\n  var destroyRef = ref(false);\n\n  function setStatus(nextStatus) {\n    if (!destroyRef.value) {\n      status.value = nextStatus;\n    }\n  }\n\n  function cancelRaf() {\n    raf.cancel(rafRef.value);\n  }\n\n  function goNextStatus(callback) {\n    cancelRaf();\n    rafRef.value = raf(function () {\n      // Only align should be manually trigger\n      var newStatus = status.value;\n\n      switch (status.value) {\n        case 'align':\n          newStatus = 'motion';\n          break;\n\n        case 'motion':\n          newStatus = 'stable';\n          break;\n\n        default:\n      }\n\n      setStatus(newStatus);\n      callback === null || callback === void 0 ? void 0 : callback();\n    });\n  }\n\n  watch(visible, function () {\n    setStatus('measure');\n  }, {\n    immediate: true,\n    flush: 'post'\n  });\n  onMounted(function () {\n    // Go next status\n    watch(status, function () {\n      switch (status.value) {\n        case 'measure':\n          doMeasure();\n          break;\n\n        default:\n      }\n\n      if (status.value) {\n        rafRef.value = raf(function () {\n          return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n            var index, nextStatus;\n            return _regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    index = StatusQueue.indexOf(status.value);\n                    nextStatus = StatusQueue[index + 1];\n\n                    if (nextStatus && index !== -1) {\n                      setStatus(nextStatus);\n                    }\n\n                  case 3:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee);\n          }));\n        });\n      }\n    }, {\n      immediate: true,\n      flush: 'post'\n    });\n  });\n  onBeforeUnmount(function () {\n    destroyRef.value = true;\n    cancelRaf();\n  });\n  return [status, goNextStatus];\n});"],"mappings":"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"},"metadata":{},"sourceType":"module"}