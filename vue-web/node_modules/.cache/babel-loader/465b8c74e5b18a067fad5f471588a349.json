{"ast":null,"code":"import { warning } from '../../../vc-util/warning';\nimport { ref } from 'vue';\n/**\n * Keep input cursor in the correct position if possible.\n * Is this necessary since we have `formatter` which may mass the content?\n */\n\nexport default function useCursor(inputRef, focused) {\n  var selectionRef = ref(null);\n\n  function recordCursor() {\n    // Record position\n    try {\n      var _inputRef$value = inputRef.value,\n          start = _inputRef$value.selectionStart,\n          end = _inputRef$value.selectionEnd,\n          value = _inputRef$value.value;\n      var beforeTxt = value.substring(0, start);\n      var afterTxt = value.substring(end);\n      selectionRef.value = {\n        start: start,\n        end: end,\n        value: value,\n        beforeTxt: beforeTxt,\n        afterTxt: afterTxt\n      };\n    } catch (e) {// Fix error in Chrome:\n      // Failed to read the 'selectionStart' property from 'HTMLInputElement'\n      // http://stackoverflow.com/q/21177489/3040605\n    }\n  }\n  /**\n   * Restore logic:\n   *  1. back string same\n   *  2. start string same\n   */\n\n\n  function restoreCursor() {\n    if (inputRef.value && selectionRef.value && focused.value) {\n      try {\n        var value = inputRef.value.value;\n        var _selectionRef$value = selectionRef.value,\n            beforeTxt = _selectionRef$value.beforeTxt,\n            afterTxt = _selectionRef$value.afterTxt,\n            start = _selectionRef$value.start;\n        var startPos = value.length;\n\n        if (value.endsWith(afterTxt)) {\n          startPos = value.length - selectionRef.value.afterTxt.length;\n        } else if (value.startsWith(beforeTxt)) {\n          startPos = beforeTxt.length;\n        } else {\n          var beforeLastChar = beforeTxt[start - 1];\n          var newIndex = value.indexOf(beforeLastChar, start - 1);\n\n          if (newIndex !== -1) {\n            startPos = newIndex + 1;\n          }\n        }\n\n        inputRef.value.setSelectionRange(startPos, startPos);\n      } catch (e) {\n        warning(false, \"Something warning of cursor restore. Please fire issue about this: \".concat(e.message));\n      }\n    }\n  }\n\n  return [recordCursor, restoreCursor];\n}","map":{"version":3,"names":["warning","ref","useCursor","inputRef","focused","selectionRef","recordCursor","_inputRef$value","value","start","selectionStart","end","selectionEnd","beforeTxt","substring","afterTxt","e","restoreCursor","_selectionRef$value","startPos","length","endsWith","startsWith","beforeLastChar","newIndex","indexOf","setSelectionRange","concat","message"],"sources":["/home/ubuntu/community/vue-web/node_modules/ant-design-vue/es/input-number/src/hooks/useCursor.js"],"sourcesContent":["import { warning } from '../../../vc-util/warning';\nimport { ref } from 'vue';\n/**\n * Keep input cursor in the correct position if possible.\n * Is this necessary since we have `formatter` which may mass the content?\n */\n\nexport default function useCursor(inputRef, focused) {\n  var selectionRef = ref(null);\n\n  function recordCursor() {\n    // Record position\n    try {\n      var _inputRef$value = inputRef.value,\n          start = _inputRef$value.selectionStart,\n          end = _inputRef$value.selectionEnd,\n          value = _inputRef$value.value;\n      var beforeTxt = value.substring(0, start);\n      var afterTxt = value.substring(end);\n      selectionRef.value = {\n        start: start,\n        end: end,\n        value: value,\n        beforeTxt: beforeTxt,\n        afterTxt: afterTxt\n      };\n    } catch (e) {// Fix error in Chrome:\n      // Failed to read the 'selectionStart' property from 'HTMLInputElement'\n      // http://stackoverflow.com/q/21177489/3040605\n    }\n  }\n  /**\n   * Restore logic:\n   *  1. back string same\n   *  2. start string same\n   */\n\n\n  function restoreCursor() {\n    if (inputRef.value && selectionRef.value && focused.value) {\n      try {\n        var value = inputRef.value.value;\n        var _selectionRef$value = selectionRef.value,\n            beforeTxt = _selectionRef$value.beforeTxt,\n            afterTxt = _selectionRef$value.afterTxt,\n            start = _selectionRef$value.start;\n        var startPos = value.length;\n\n        if (value.endsWith(afterTxt)) {\n          startPos = value.length - selectionRef.value.afterTxt.length;\n        } else if (value.startsWith(beforeTxt)) {\n          startPos = beforeTxt.length;\n        } else {\n          var beforeLastChar = beforeTxt[start - 1];\n          var newIndex = value.indexOf(beforeLastChar, start - 1);\n\n          if (newIndex !== -1) {\n            startPos = newIndex + 1;\n          }\n        }\n\n        inputRef.value.setSelectionRange(startPos, startPos);\n      } catch (e) {\n        warning(false, \"Something warning of cursor restore. Please fire issue about this: \".concat(e.message));\n      }\n    }\n  }\n\n  return [recordCursor, restoreCursor];\n}"],"mappings":"AAAA,SAASA,OAAT,QAAwB,0BAAxB;AACA,SAASC,GAAT,QAAoB,KAApB;AACA;AACA;AACA;AACA;;AAEA,eAAe,SAASC,SAAT,CAAmBC,QAAnB,EAA6BC,OAA7B,EAAsC;EACnD,IAAIC,YAAY,GAAGJ,GAAG,CAAC,IAAD,CAAtB;;EAEA,SAASK,YAAT,GAAwB;IACtB;IACA,IAAI;MACF,IAAIC,eAAe,GAAGJ,QAAQ,CAACK,KAA/B;MAAA,IACIC,KAAK,GAAGF,eAAe,CAACG,cAD5B;MAAA,IAEIC,GAAG,GAAGJ,eAAe,CAACK,YAF1B;MAAA,IAGIJ,KAAK,GAAGD,eAAe,CAACC,KAH5B;MAIA,IAAIK,SAAS,GAAGL,KAAK,CAACM,SAAN,CAAgB,CAAhB,EAAmBL,KAAnB,CAAhB;MACA,IAAIM,QAAQ,GAAGP,KAAK,CAACM,SAAN,CAAgBH,GAAhB,CAAf;MACAN,YAAY,CAACG,KAAb,GAAqB;QACnBC,KAAK,EAAEA,KADY;QAEnBE,GAAG,EAAEA,GAFc;QAGnBH,KAAK,EAAEA,KAHY;QAInBK,SAAS,EAAEA,SAJQ;QAKnBE,QAAQ,EAAEA;MALS,CAArB;IAOD,CAdD,CAcE,OAAOC,CAAP,EAAU,CAAC;MACX;MACA;IACD;EACF;EACD;AACF;AACA;AACA;AACA;;;EAGE,SAASC,aAAT,GAAyB;IACvB,IAAId,QAAQ,CAACK,KAAT,IAAkBH,YAAY,CAACG,KAA/B,IAAwCJ,OAAO,CAACI,KAApD,EAA2D;MACzD,IAAI;QACF,IAAIA,KAAK,GAAGL,QAAQ,CAACK,KAAT,CAAeA,KAA3B;QACA,IAAIU,mBAAmB,GAAGb,YAAY,CAACG,KAAvC;QAAA,IACIK,SAAS,GAAGK,mBAAmB,CAACL,SADpC;QAAA,IAEIE,QAAQ,GAAGG,mBAAmB,CAACH,QAFnC;QAAA,IAGIN,KAAK,GAAGS,mBAAmB,CAACT,KAHhC;QAIA,IAAIU,QAAQ,GAAGX,KAAK,CAACY,MAArB;;QAEA,IAAIZ,KAAK,CAACa,QAAN,CAAeN,QAAf,CAAJ,EAA8B;UAC5BI,QAAQ,GAAGX,KAAK,CAACY,MAAN,GAAef,YAAY,CAACG,KAAb,CAAmBO,QAAnB,CAA4BK,MAAtD;QACD,CAFD,MAEO,IAAIZ,KAAK,CAACc,UAAN,CAAiBT,SAAjB,CAAJ,EAAiC;UACtCM,QAAQ,GAAGN,SAAS,CAACO,MAArB;QACD,CAFM,MAEA;UACL,IAAIG,cAAc,GAAGV,SAAS,CAACJ,KAAK,GAAG,CAAT,CAA9B;UACA,IAAIe,QAAQ,GAAGhB,KAAK,CAACiB,OAAN,CAAcF,cAAd,EAA8Bd,KAAK,GAAG,CAAtC,CAAf;;UAEA,IAAIe,QAAQ,KAAK,CAAC,CAAlB,EAAqB;YACnBL,QAAQ,GAAGK,QAAQ,GAAG,CAAtB;UACD;QACF;;QAEDrB,QAAQ,CAACK,KAAT,CAAekB,iBAAf,CAAiCP,QAAjC,EAA2CA,QAA3C;MACD,CAtBD,CAsBE,OAAOH,CAAP,EAAU;QACVhB,OAAO,CAAC,KAAD,EAAQ,sEAAsE2B,MAAtE,CAA6EX,CAAC,CAACY,OAA/E,CAAR,CAAP;MACD;IACF;EACF;;EAED,OAAO,CAACtB,YAAD,EAAeW,aAAf,CAAP;AACD"},"metadata":{},"sourceType":"module"}