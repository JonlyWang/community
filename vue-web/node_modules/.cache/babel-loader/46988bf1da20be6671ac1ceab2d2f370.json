{"ast":null,"code":"import { watch, ref } from 'vue';\nexport default function useHeights(mergedData, getKey, onItemAdd, onItemRemove) {\n  var instance = new Map();\n  var heights = new Map();\n  var updatedMark = ref(Symbol('update'));\n  watch(mergedData, function () {\n    updatedMark.value = Symbol('update');\n  });\n  var heightUpdateId = 0;\n\n  function collectHeight() {\n    heightUpdateId += 1;\n    var currentId = heightUpdateId;\n    Promise.resolve().then(function () {\n      // Only collect when it's latest call\n      if (currentId !== heightUpdateId) return; // let changed = false;\n\n      instance.forEach(function (element, key) {\n        if (element && element.offsetParent) {\n          var offsetHeight = element.offsetHeight;\n\n          if (heights.get(key) !== offsetHeight) {\n            //changed = true;\n            updatedMark.value = Symbol('update');\n            heights.set(key, element.offsetHeight);\n          }\n        }\n      });\n    });\n  }\n\n  function setInstance(item, ins) {\n    var key = getKey(item);\n    var origin = instance.get(key);\n\n    if (ins) {\n      instance.set(key, ins.$el || ins);\n      collectHeight();\n    } else {\n      instance.delete(key);\n    } // Instance changed\n\n\n    if (!origin !== !ins) {\n      if (ins) {\n        onItemAdd === null || onItemAdd === void 0 ? void 0 : onItemAdd(item);\n      } else {\n        onItemRemove === null || onItemRemove === void 0 ? void 0 : onItemRemove(item);\n      }\n    }\n  }\n\n  return [setInstance, collectHeight, heights, updatedMark];\n}","map":{"version":3,"names":["watch","ref","useHeights","mergedData","getKey","onItemAdd","onItemRemove","instance","Map","heights","updatedMark","Symbol","value","heightUpdateId","collectHeight","currentId","Promise","resolve","then","forEach","element","key","offsetParent","offsetHeight","get","set","setInstance","item","ins","origin","$el","delete"],"sources":["/home/ubuntu/community/vue-web/node_modules/ant-design-vue/es/vc-virtual-list/hooks/useHeights.js"],"sourcesContent":["import { watch, ref } from 'vue';\nexport default function useHeights(mergedData, getKey, onItemAdd, onItemRemove) {\n  var instance = new Map();\n  var heights = new Map();\n  var updatedMark = ref(Symbol('update'));\n  watch(mergedData, function () {\n    updatedMark.value = Symbol('update');\n  });\n  var heightUpdateId = 0;\n\n  function collectHeight() {\n    heightUpdateId += 1;\n    var currentId = heightUpdateId;\n    Promise.resolve().then(function () {\n      // Only collect when it's latest call\n      if (currentId !== heightUpdateId) return; // let changed = false;\n\n      instance.forEach(function (element, key) {\n        if (element && element.offsetParent) {\n          var offsetHeight = element.offsetHeight;\n\n          if (heights.get(key) !== offsetHeight) {\n            //changed = true;\n            updatedMark.value = Symbol('update');\n            heights.set(key, element.offsetHeight);\n          }\n        }\n      });\n    });\n  }\n\n  function setInstance(item, ins) {\n    var key = getKey(item);\n    var origin = instance.get(key);\n\n    if (ins) {\n      instance.set(key, ins.$el || ins);\n      collectHeight();\n    } else {\n      instance.delete(key);\n    } // Instance changed\n\n\n    if (!origin !== !ins) {\n      if (ins) {\n        onItemAdd === null || onItemAdd === void 0 ? void 0 : onItemAdd(item);\n      } else {\n        onItemRemove === null || onItemRemove === void 0 ? void 0 : onItemRemove(item);\n      }\n    }\n  }\n\n  return [setInstance, collectHeight, heights, updatedMark];\n}"],"mappings":"AAAA,SAASA,KAAT,EAAgBC,GAAhB,QAA2B,KAA3B;AACA,eAAe,SAASC,UAAT,CAAoBC,UAApB,EAAgCC,MAAhC,EAAwCC,SAAxC,EAAmDC,YAAnD,EAAiE;EAC9E,IAAIC,QAAQ,GAAG,IAAIC,GAAJ,EAAf;EACA,IAAIC,OAAO,GAAG,IAAID,GAAJ,EAAd;EACA,IAAIE,WAAW,GAAGT,GAAG,CAACU,MAAM,CAAC,QAAD,CAAP,CAArB;EACAX,KAAK,CAACG,UAAD,EAAa,YAAY;IAC5BO,WAAW,CAACE,KAAZ,GAAoBD,MAAM,CAAC,QAAD,CAA1B;EACD,CAFI,CAAL;EAGA,IAAIE,cAAc,GAAG,CAArB;;EAEA,SAASC,aAAT,GAAyB;IACvBD,cAAc,IAAI,CAAlB;IACA,IAAIE,SAAS,GAAGF,cAAhB;IACAG,OAAO,CAACC,OAAR,GAAkBC,IAAlB,CAAuB,YAAY;MACjC;MACA,IAAIH,SAAS,KAAKF,cAAlB,EAAkC,OAFD,CAES;;MAE1CN,QAAQ,CAACY,OAAT,CAAiB,UAAUC,OAAV,EAAmBC,GAAnB,EAAwB;QACvC,IAAID,OAAO,IAAIA,OAAO,CAACE,YAAvB,EAAqC;UACnC,IAAIC,YAAY,GAAGH,OAAO,CAACG,YAA3B;;UAEA,IAAId,OAAO,CAACe,GAAR,CAAYH,GAAZ,MAAqBE,YAAzB,EAAuC;YACrC;YACAb,WAAW,CAACE,KAAZ,GAAoBD,MAAM,CAAC,QAAD,CAA1B;YACAF,OAAO,CAACgB,GAAR,CAAYJ,GAAZ,EAAiBD,OAAO,CAACG,YAAzB;UACD;QACF;MACF,CAVD;IAWD,CAfD;EAgBD;;EAED,SAASG,WAAT,CAAqBC,IAArB,EAA2BC,GAA3B,EAAgC;IAC9B,IAAIP,GAAG,GAAGjB,MAAM,CAACuB,IAAD,CAAhB;IACA,IAAIE,MAAM,GAAGtB,QAAQ,CAACiB,GAAT,CAAaH,GAAb,CAAb;;IAEA,IAAIO,GAAJ,EAAS;MACPrB,QAAQ,CAACkB,GAAT,CAAaJ,GAAb,EAAkBO,GAAG,CAACE,GAAJ,IAAWF,GAA7B;MACAd,aAAa;IACd,CAHD,MAGO;MACLP,QAAQ,CAACwB,MAAT,CAAgBV,GAAhB;IACD,CAT6B,CAS5B;;;IAGF,IAAI,CAACQ,MAAD,KAAY,CAACD,GAAjB,EAAsB;MACpB,IAAIA,GAAJ,EAAS;QACPvB,SAAS,KAAK,IAAd,IAAsBA,SAAS,KAAK,KAAK,CAAzC,GAA6C,KAAK,CAAlD,GAAsDA,SAAS,CAACsB,IAAD,CAA/D;MACD,CAFD,MAEO;QACLrB,YAAY,KAAK,IAAjB,IAAyBA,YAAY,KAAK,KAAK,CAA/C,GAAmD,KAAK,CAAxD,GAA4DA,YAAY,CAACqB,IAAD,CAAxE;MACD;IACF;EACF;;EAED,OAAO,CAACD,WAAD,EAAcZ,aAAd,EAA6BL,OAA7B,EAAsCC,WAAtC,CAAP;AACD"},"metadata":{},"sourceType":"module"}