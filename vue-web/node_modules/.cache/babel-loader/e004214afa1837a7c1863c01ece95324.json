{"ast":null,"code":"import { getValue, updateValues } from '../utils/miscUtil';\nimport { getClosingViewDate, isSameYear, isSameMonth, isSameDecade } from '../utils/dateUtil';\nimport { watchEffect, computed, ref } from 'vue';\n\nfunction getStartEndDistance(startDate, endDate, picker, generateConfig) {\n  var startNext = getClosingViewDate(startDate, picker, generateConfig, 1);\n\n  function getDistance(compareFunc) {\n    if (compareFunc(startDate, endDate)) {\n      return 'same';\n    }\n\n    if (compareFunc(startNext, endDate)) {\n      return 'closing';\n    }\n\n    return 'far';\n  }\n\n  switch (picker) {\n    case 'year':\n      return getDistance(function (start, end) {\n        return isSameDecade(generateConfig, start, end);\n      });\n\n    case 'quarter':\n    case 'month':\n      return getDistance(function (start, end) {\n        return isSameYear(generateConfig, start, end);\n      });\n\n    default:\n      return getDistance(function (start, end) {\n        return isSameMonth(generateConfig, start, end);\n      });\n  }\n}\n\nfunction getRangeViewDate(values, index, picker, generateConfig) {\n  var startDate = getValue(values, 0);\n  var endDate = getValue(values, 1);\n\n  if (index === 0) {\n    return startDate;\n  }\n\n  if (startDate && endDate) {\n    var distance = getStartEndDistance(startDate, endDate, picker, generateConfig);\n\n    switch (distance) {\n      case 'same':\n        return startDate;\n\n      case 'closing':\n        return startDate;\n\n      default:\n        return getClosingViewDate(endDate, picker, generateConfig, -1);\n    }\n  }\n\n  return startDate;\n}\n\nexport default function useRangeViewDates(_ref) {\n  var values = _ref.values,\n      picker = _ref.picker,\n      defaultDates = _ref.defaultDates,\n      generateConfig = _ref.generateConfig;\n  var defaultViewDates = ref([getValue(defaultDates, 0), getValue(defaultDates, 1)]);\n  var viewDates = ref(null);\n  var startDate = computed(function () {\n    return getValue(values.value, 0);\n  });\n  var endDate = computed(function () {\n    return getValue(values.value, 1);\n  });\n\n  var getViewDate = function getViewDate(index) {\n    // If set default view date, use it\n    if (defaultViewDates.value[index]) {\n      return defaultViewDates.value[index];\n    }\n\n    return getValue(viewDates.value, index) || getRangeViewDate(values.value, index, picker.value, generateConfig.value) || startDate.value || endDate.value || generateConfig.value.getNow();\n  };\n\n  var startViewDate = ref(null);\n  var endViewDate = ref(null);\n  watchEffect(function () {\n    startViewDate.value = getViewDate(0);\n    endViewDate.value = getViewDate(1);\n  });\n\n  function setViewDate(viewDate, index) {\n    if (viewDate) {\n      var newViewDates = updateValues(viewDates.value, viewDate, index); // Set view date will clean up default one\n      // Should always be an array\n\n      defaultViewDates.value = updateValues(defaultViewDates.value, null, index) || [null, null]; // Reset another one when not have value\n\n      var anotherIndex = (index + 1) % 2;\n\n      if (!getValue(values.value, anotherIndex)) {\n        newViewDates = updateValues(newViewDates, viewDate, anotherIndex);\n      }\n\n      viewDates.value = newViewDates;\n    } else if (startDate.value || endDate.value) {\n      // Reset all when has values when `viewDate` is `null` which means from open trigger\n      viewDates.value = null;\n    }\n  }\n\n  return [startViewDate, endViewDate, setViewDate];\n}","map":{"version":3,"names":["getValue","updateValues","getClosingViewDate","isSameYear","isSameMonth","isSameDecade","watchEffect","computed","ref","getStartEndDistance","startDate","endDate","picker","generateConfig","startNext","getDistance","compareFunc","start","end","getRangeViewDate","values","index","distance","useRangeViewDates","_ref","defaultDates","defaultViewDates","viewDates","value","getViewDate","getNow","startViewDate","endViewDate","setViewDate","viewDate","newViewDates","anotherIndex"],"sources":["C:/Users/USTC/Desktop/community1/vue-web/node_modules/ant-design-vue/es/vc-picker/hooks/useRangeViewDates.js"],"sourcesContent":["import { getValue, updateValues } from '../utils/miscUtil';\nimport { getClosingViewDate, isSameYear, isSameMonth, isSameDecade } from '../utils/dateUtil';\nimport { watchEffect, computed, ref } from 'vue';\n\nfunction getStartEndDistance(startDate, endDate, picker, generateConfig) {\n  var startNext = getClosingViewDate(startDate, picker, generateConfig, 1);\n\n  function getDistance(compareFunc) {\n    if (compareFunc(startDate, endDate)) {\n      return 'same';\n    }\n\n    if (compareFunc(startNext, endDate)) {\n      return 'closing';\n    }\n\n    return 'far';\n  }\n\n  switch (picker) {\n    case 'year':\n      return getDistance(function (start, end) {\n        return isSameDecade(generateConfig, start, end);\n      });\n\n    case 'quarter':\n    case 'month':\n      return getDistance(function (start, end) {\n        return isSameYear(generateConfig, start, end);\n      });\n\n    default:\n      return getDistance(function (start, end) {\n        return isSameMonth(generateConfig, start, end);\n      });\n  }\n}\n\nfunction getRangeViewDate(values, index, picker, generateConfig) {\n  var startDate = getValue(values, 0);\n  var endDate = getValue(values, 1);\n\n  if (index === 0) {\n    return startDate;\n  }\n\n  if (startDate && endDate) {\n    var distance = getStartEndDistance(startDate, endDate, picker, generateConfig);\n\n    switch (distance) {\n      case 'same':\n        return startDate;\n\n      case 'closing':\n        return startDate;\n\n      default:\n        return getClosingViewDate(endDate, picker, generateConfig, -1);\n    }\n  }\n\n  return startDate;\n}\n\nexport default function useRangeViewDates(_ref) {\n  var values = _ref.values,\n      picker = _ref.picker,\n      defaultDates = _ref.defaultDates,\n      generateConfig = _ref.generateConfig;\n  var defaultViewDates = ref([getValue(defaultDates, 0), getValue(defaultDates, 1)]);\n  var viewDates = ref(null);\n  var startDate = computed(function () {\n    return getValue(values.value, 0);\n  });\n  var endDate = computed(function () {\n    return getValue(values.value, 1);\n  });\n\n  var getViewDate = function getViewDate(index) {\n    // If set default view date, use it\n    if (defaultViewDates.value[index]) {\n      return defaultViewDates.value[index];\n    }\n\n    return getValue(viewDates.value, index) || getRangeViewDate(values.value, index, picker.value, generateConfig.value) || startDate.value || endDate.value || generateConfig.value.getNow();\n  };\n\n  var startViewDate = ref(null);\n  var endViewDate = ref(null);\n  watchEffect(function () {\n    startViewDate.value = getViewDate(0);\n    endViewDate.value = getViewDate(1);\n  });\n\n  function setViewDate(viewDate, index) {\n    if (viewDate) {\n      var newViewDates = updateValues(viewDates.value, viewDate, index); // Set view date will clean up default one\n      // Should always be an array\n\n      defaultViewDates.value = updateValues(defaultViewDates.value, null, index) || [null, null]; // Reset another one when not have value\n\n      var anotherIndex = (index + 1) % 2;\n\n      if (!getValue(values.value, anotherIndex)) {\n        newViewDates = updateValues(newViewDates, viewDate, anotherIndex);\n      }\n\n      viewDates.value = newViewDates;\n    } else if (startDate.value || endDate.value) {\n      // Reset all when has values when `viewDate` is `null` which means from open trigger\n      viewDates.value = null;\n    }\n  }\n\n  return [startViewDate, endViewDate, setViewDate];\n}"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,YAAnB,QAAuC,mBAAvC;AACA,SAASC,kBAAT,EAA6BC,UAA7B,EAAyCC,WAAzC,EAAsDC,YAAtD,QAA0E,mBAA1E;AACA,SAASC,WAAT,EAAsBC,QAAtB,EAAgCC,GAAhC,QAA2C,KAA3C;;AAEA,SAASC,mBAAT,CAA6BC,SAA7B,EAAwCC,OAAxC,EAAiDC,MAAjD,EAAyDC,cAAzD,EAAyE;EACvE,IAAIC,SAAS,GAAGZ,kBAAkB,CAACQ,SAAD,EAAYE,MAAZ,EAAoBC,cAApB,EAAoC,CAApC,CAAlC;;EAEA,SAASE,WAAT,CAAqBC,WAArB,EAAkC;IAChC,IAAIA,WAAW,CAACN,SAAD,EAAYC,OAAZ,CAAf,EAAqC;MACnC,OAAO,MAAP;IACD;;IAED,IAAIK,WAAW,CAACF,SAAD,EAAYH,OAAZ,CAAf,EAAqC;MACnC,OAAO,SAAP;IACD;;IAED,OAAO,KAAP;EACD;;EAED,QAAQC,MAAR;IACE,KAAK,MAAL;MACE,OAAOG,WAAW,CAAC,UAAUE,KAAV,EAAiBC,GAAjB,EAAsB;QACvC,OAAOb,YAAY,CAACQ,cAAD,EAAiBI,KAAjB,EAAwBC,GAAxB,CAAnB;MACD,CAFiB,CAAlB;;IAIF,KAAK,SAAL;IACA,KAAK,OAAL;MACE,OAAOH,WAAW,CAAC,UAAUE,KAAV,EAAiBC,GAAjB,EAAsB;QACvC,OAAOf,UAAU,CAACU,cAAD,EAAiBI,KAAjB,EAAwBC,GAAxB,CAAjB;MACD,CAFiB,CAAlB;;IAIF;MACE,OAAOH,WAAW,CAAC,UAAUE,KAAV,EAAiBC,GAAjB,EAAsB;QACvC,OAAOd,WAAW,CAACS,cAAD,EAAiBI,KAAjB,EAAwBC,GAAxB,CAAlB;MACD,CAFiB,CAAlB;EAbJ;AAiBD;;AAED,SAASC,gBAAT,CAA0BC,MAA1B,EAAkCC,KAAlC,EAAyCT,MAAzC,EAAiDC,cAAjD,EAAiE;EAC/D,IAAIH,SAAS,GAAGV,QAAQ,CAACoB,MAAD,EAAS,CAAT,CAAxB;EACA,IAAIT,OAAO,GAAGX,QAAQ,CAACoB,MAAD,EAAS,CAAT,CAAtB;;EAEA,IAAIC,KAAK,KAAK,CAAd,EAAiB;IACf,OAAOX,SAAP;EACD;;EAED,IAAIA,SAAS,IAAIC,OAAjB,EAA0B;IACxB,IAAIW,QAAQ,GAAGb,mBAAmB,CAACC,SAAD,EAAYC,OAAZ,EAAqBC,MAArB,EAA6BC,cAA7B,CAAlC;;IAEA,QAAQS,QAAR;MACE,KAAK,MAAL;QACE,OAAOZ,SAAP;;MAEF,KAAK,SAAL;QACE,OAAOA,SAAP;;MAEF;QACE,OAAOR,kBAAkB,CAACS,OAAD,EAAUC,MAAV,EAAkBC,cAAlB,EAAkC,CAAC,CAAnC,CAAzB;IARJ;EAUD;;EAED,OAAOH,SAAP;AACD;;AAED,eAAe,SAASa,iBAAT,CAA2BC,IAA3B,EAAiC;EAC9C,IAAIJ,MAAM,GAAGI,IAAI,CAACJ,MAAlB;EAAA,IACIR,MAAM,GAAGY,IAAI,CAACZ,MADlB;EAAA,IAEIa,YAAY,GAAGD,IAAI,CAACC,YAFxB;EAAA,IAGIZ,cAAc,GAAGW,IAAI,CAACX,cAH1B;EAIA,IAAIa,gBAAgB,GAAGlB,GAAG,CAAC,CAACR,QAAQ,CAACyB,YAAD,EAAe,CAAf,CAAT,EAA4BzB,QAAQ,CAACyB,YAAD,EAAe,CAAf,CAApC,CAAD,CAA1B;EACA,IAAIE,SAAS,GAAGnB,GAAG,CAAC,IAAD,CAAnB;EACA,IAAIE,SAAS,GAAGH,QAAQ,CAAC,YAAY;IACnC,OAAOP,QAAQ,CAACoB,MAAM,CAACQ,KAAR,EAAe,CAAf,CAAf;EACD,CAFuB,CAAxB;EAGA,IAAIjB,OAAO,GAAGJ,QAAQ,CAAC,YAAY;IACjC,OAAOP,QAAQ,CAACoB,MAAM,CAACQ,KAAR,EAAe,CAAf,CAAf;EACD,CAFqB,CAAtB;;EAIA,IAAIC,WAAW,GAAG,SAASA,WAAT,CAAqBR,KAArB,EAA4B;IAC5C;IACA,IAAIK,gBAAgB,CAACE,KAAjB,CAAuBP,KAAvB,CAAJ,EAAmC;MACjC,OAAOK,gBAAgB,CAACE,KAAjB,CAAuBP,KAAvB,CAAP;IACD;;IAED,OAAOrB,QAAQ,CAAC2B,SAAS,CAACC,KAAX,EAAkBP,KAAlB,CAAR,IAAoCF,gBAAgB,CAACC,MAAM,CAACQ,KAAR,EAAeP,KAAf,EAAsBT,MAAM,CAACgB,KAA7B,EAAoCf,cAAc,CAACe,KAAnD,CAApD,IAAiHlB,SAAS,CAACkB,KAA3H,IAAoIjB,OAAO,CAACiB,KAA5I,IAAqJf,cAAc,CAACe,KAAf,CAAqBE,MAArB,EAA5J;EACD,CAPD;;EASA,IAAIC,aAAa,GAAGvB,GAAG,CAAC,IAAD,CAAvB;EACA,IAAIwB,WAAW,GAAGxB,GAAG,CAAC,IAAD,CAArB;EACAF,WAAW,CAAC,YAAY;IACtByB,aAAa,CAACH,KAAd,GAAsBC,WAAW,CAAC,CAAD,CAAjC;IACAG,WAAW,CAACJ,KAAZ,GAAoBC,WAAW,CAAC,CAAD,CAA/B;EACD,CAHU,CAAX;;EAKA,SAASI,WAAT,CAAqBC,QAArB,EAA+Bb,KAA/B,EAAsC;IACpC,IAAIa,QAAJ,EAAc;MACZ,IAAIC,YAAY,GAAGlC,YAAY,CAAC0B,SAAS,CAACC,KAAX,EAAkBM,QAAlB,EAA4Bb,KAA5B,CAA/B,CADY,CACuD;MACnE;;MAEAK,gBAAgB,CAACE,KAAjB,GAAyB3B,YAAY,CAACyB,gBAAgB,CAACE,KAAlB,EAAyB,IAAzB,EAA+BP,KAA/B,CAAZ,IAAqD,CAAC,IAAD,EAAO,IAAP,CAA9E,CAJY,CAIgF;;MAE5F,IAAIe,YAAY,GAAG,CAACf,KAAK,GAAG,CAAT,IAAc,CAAjC;;MAEA,IAAI,CAACrB,QAAQ,CAACoB,MAAM,CAACQ,KAAR,EAAeQ,YAAf,CAAb,EAA2C;QACzCD,YAAY,GAAGlC,YAAY,CAACkC,YAAD,EAAeD,QAAf,EAAyBE,YAAzB,CAA3B;MACD;;MAEDT,SAAS,CAACC,KAAV,GAAkBO,YAAlB;IACD,CAbD,MAaO,IAAIzB,SAAS,CAACkB,KAAV,IAAmBjB,OAAO,CAACiB,KAA/B,EAAsC;MAC3C;MACAD,SAAS,CAACC,KAAV,GAAkB,IAAlB;IACD;EACF;;EAED,OAAO,CAACG,aAAD,EAAgBC,WAAhB,EAA6BC,WAA7B,CAAP;AACD"},"metadata":{},"sourceType":"module"}